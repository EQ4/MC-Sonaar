#N canvas 668 72 1086 627 10;
#X declare -path ../essentiaRT~ -path ../utils -path ../ibt_pd;
#X obj 267 -134 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj -65 78 output~;
#X obj 288 -263 route list;
#X obj 288 -242 route onset_strength;
#X obj 288 -156 sel 1;
#X floatatom 303 -199 5 0 0 0 - init_threshold -;
#X obj 288 -178 > 1;
#N canvas 0 22 378 376 list-of-onsets-in-buffer 0;
#X obj 39 13 inlet;
#X obj 39 57 timer;
#X obj 39 79 list prepend;
#X obj 193 194 list split 1;
#X obj 7 104 t l l;
#X obj 218 139 sum;
#X obj 203 272 list append;
#X msg 214 246 1;
#X obj 164 219 route bang;
#X msg 177 246 0;
#X obj 154 304 route 1 0;
#X obj 39 35 t b b;
#X obj 179 327 outlet;
#X obj 108 35 inlet;
#X obj 108 57 bang;
#X obj 263 139 r buffer_size;
#X obj 218 161 >= 10000;
#X connect 0 0 11 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 0 8 0;
#X connect 3 1 6 1;
#X connect 4 0 3 0;
#X connect 4 1 5 0;
#X connect 5 0 16 0;
#X connect 6 0 10 0;
#X connect 7 0 6 0;
#X connect 8 0 9 0;
#X connect 8 1 7 0;
#X connect 9 0 6 0;
#X connect 10 0 4 0;
#X connect 10 1 2 1;
#X connect 10 1 12 0;
#X connect 11 0 1 0;
#X connect 11 1 1 1;
#X connect 13 0 14 0;
#X connect 14 0 2 1;
#X connect 15 0 16 1;
#X connect 16 0 3 1;
#X restore 288 -109 pd list-of-onsets-in-buffer;
#X msg 447 -131 reset;
#X obj 36 -104 catch~ slices;
#X obj 251 -307 essentiaRT~ 5;
#X text -130 -462 ...assuming externals are in parent folder...;
#X text -133 -318 AUDIO INPUT;
#X text -133 -310 =====================;
#X text 247 -355 ONSET DETECTION;
#X text 247 -347 =====================;
#X floatatom 297 -220 5 0 0 0 - - -;
#X text 334 -221 onset strength;
#X obj 247 -478 loadbang;
#X obj 288 -285 spigot 1;
#X obj 343 -305 tgl 15 1 empty empty empty 17 7 0 10 -262144 -1 -1
1 1;
#X text 364 -307 output onsets;
#X floatatom 363 -154 5 0 0 0 - init_filterevents -;
#X text -133 -144 =====================;
#X text -133 -152 AUDIO OUTPUT;
#X msg -129 -267 station \$1;
#X floatatom -129 -288 5 0 7 0 - - -;
#X obj -90 -221 print STATION;
#X obj -129 -243 radioin;
#X obj -70 -104 hsl 100 15 0 1 0 1 empty init_volume empty -2 -8 0
10 -262144 -1 -1 4200 1;
#X obj -33 9 line~;
#X obj -73 9 line~;
#X obj 21 41 *~;
#X obj -129 41 *~;
#X obj -73 -78 - 1;
#X obj -73 -57 abs;
#X obj -73 -35 sqrt;
#X msg -73 -13 \$1 20;
#X obj -33 -78 sqrt;
#X text -73 -121 crossfade;
#X obj -129 -104 r~ input;
#X obj -129 -177 s~ input;
#X obj 251 -328 r~ input;
#X text -133 -420 =====================;
#X obj 38 -199 s buffer_size;
#X floatatom 38 -219 5 0 0 0 - init_buffer_size -;
#X obj 296 -46 print ONSET-TIMES;
#X obj 267 -114 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X msg -33 -13 \$1 20;
#X obj -121 -199 delwrite~ \$0-deline 10000;
#X text -131 -428 essentiaRT~ example-2;
#X obj 288 -23 s onset_times;
#X text 502 -476 =====================;
#X text 502 -484 ONSET RETRIEVAL;
#X obj 563 -260 metro 300;
#X obj 563 -281 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1
1 1;
#X obj 656 -260 r onset_times;
#X obj 596 -172 timer;
#X obj 665 -16 +;
#X obj 681 -85 random;
#X obj 714 -107 length;
#X obj 695 75 throw~ slices;
#X obj 665 29 delread~ \$0-deline;
#X obj 695 53 *~;
#X obj 662 -59 list split;
#X obj 690 -37 sum;
#X obj 662 -211 list;
#X obj 656 -239 t b l;
#X obj 563 -238 t b b;
#X obj 662 -129 t l b l;
#X obj 665 6 quickenv 5;
#X text 671 -160 between onset report and query.;
#X obj 505 -434 ibt_pd;
#X obj 505 -456 r~ input;
#X obj -129 -478 declare -path ../essentiaRT~ -path ../utils -path
../ibt_pd;
#X text 548 -435 <- bpm estimation;
#X obj 288 -134 filtevent 500;
#X floatatom 632 -410 5 0 0 1 manual init_manual_tempo -;
#X obj 614 -351 pack f f;
#X obj 632 -387 t b f;
#X obj 677 -369 tgl 15 1 empty empty empty 17 7 0 10 -262144 -1 -1
0 1;
#X obj 677 -344 + 1;
#X floatatom 538 -411 5 0 0 1 automatic - -;
#X obj 614 -281 /;
#X msg 614 -304 60000 \$1;
#X floatatom 687 -310 5 0 0 0 - - -;
#X text 700 -379 accomodate mashup to original tempo (0);
#X text 700 -366 or introduce tempo manually (1);
#X msg 247 -455 bang \; pd dsp 1 \; init_threshold set 1 \; init_filterevents
set 500 \; init_volume 0.5 \; init_buffer_size set 10000 \; init_manual_tempo
100;
#X text 632 -174 <<--- extra timer to measure the elapsed time;
#X text 479 -282 start mashup!;
#X obj 296 -67 spigot 0;
#X obj 341 -87 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X text -131 -408 This example uses an independent clock (metro) to
playback the incoming audio at the selected onset positions. We achieve
that by using an extra timer to measure the elapsed time between the
last onset-list reported and the query time.;
#X obj 614 -327 packel 1;
#X text -91 -289 pick a radio station (0-7);
#X connect 2 0 3 0;
#X connect 3 0 6 0;
#X connect 3 0 16 0;
#X connect 4 0 0 0;
#X connect 4 0 76 0;
#X connect 5 0 6 1;
#X connect 6 0 4 0;
#X connect 7 0 51 0;
#X connect 7 0 91 0;
#X connect 8 0 7 1;
#X connect 9 0 32 1;
#X connect 10 1 19 0;
#X connect 18 0 88 0;
#X connect 19 0 2 0;
#X connect 20 0 19 1;
#X connect 22 0 76 1;
#X connect 25 0 28 0;
#X connect 26 0 25 0;
#X connect 28 0 41 0;
#X connect 28 0 49 0;
#X connect 28 2 27 0;
#X connect 29 0 34 0;
#X connect 29 0 38 0;
#X connect 30 0 32 0;
#X connect 31 0 33 1;
#X connect 32 0 1 1;
#X connect 33 0 1 0;
#X connect 34 0 35 0;
#X connect 35 0 36 0;
#X connect 36 0 37 0;
#X connect 37 0 31 0;
#X connect 38 0 48 0;
#X connect 40 0 33 0;
#X connect 42 0 10 0;
#X connect 45 0 44 0;
#X connect 48 0 30 0;
#X connect 54 0 68 0;
#X connect 55 0 54 0;
#X connect 56 0 67 0;
#X connect 57 0 58 0;
#X connect 58 0 70 0;
#X connect 59 0 64 1;
#X connect 60 0 59 1;
#X connect 62 0 63 0;
#X connect 63 0 61 0;
#X connect 64 1 65 0;
#X connect 65 0 58 1;
#X connect 66 0 69 0;
#X connect 67 0 57 0;
#X connect 67 1 66 1;
#X connect 68 0 57 1;
#X connect 68 1 66 0;
#X connect 69 0 64 0;
#X connect 69 1 59 0;
#X connect 69 2 60 0;
#X connect 70 0 62 0;
#X connect 70 1 63 1;
#X connect 72 1 82 0;
#X connect 73 0 72 0;
#X connect 76 0 7 0;
#X connect 76 0 47 0;
#X connect 77 0 79 0;
#X connect 78 0 94 0;
#X connect 79 0 78 0;
#X connect 79 1 78 1;
#X connect 80 0 81 0;
#X connect 81 0 94 1;
#X connect 82 0 78 0;
#X connect 83 0 54 1;
#X connect 84 0 83 0;
#X connect 91 0 46 0;
#X connect 92 0 91 1;
#X connect 94 0 84 0;
#X connect 94 0 85 0;
