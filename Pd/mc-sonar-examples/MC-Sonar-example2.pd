#N canvas 664 22 841 801 10;
#X declare -path ../essentiaRT~ -path ../utils;
#X obj 257 6 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj -75 231 output~;
#X obj 278 -123 route list;
#X obj 278 -102 route onset_strength;
#X obj 278 -16 sel 1;
#X floatatom 293 -59 5 0 0 0 - init_threshold -;
#X obj 278 -38 > 1;
#N canvas 0 22 378 376 list-of-onsets-in-buffer 0;
#X obj 39 13 inlet;
#X obj 39 57 timer;
#X obj 39 79 list prepend;
#X obj 193 194 list split 1;
#X obj 7 104 t l l;
#X obj 218 139 sum;
#X obj 203 272 list append;
#X msg 214 246 1;
#X obj 164 219 route bang;
#X msg 177 246 0;
#X obj 154 304 route 1 0;
#X obj 39 35 t b b;
#X obj 179 327 outlet;
#X obj 108 35 inlet;
#X obj 108 57 bang;
#X obj 263 139 r buffer_size;
#X obj 218 161 >= 10000;
#X connect 0 0 11 0;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 0 8 0;
#X connect 3 1 6 1;
#X connect 4 0 3 0;
#X connect 4 1 5 0;
#X connect 5 0 16 0;
#X connect 6 0 10 0;
#X connect 7 0 6 0;
#X connect 8 0 9 0;
#X connect 8 1 7 0;
#X connect 9 0 6 0;
#X connect 10 0 4 0;
#X connect 10 1 2 1;
#X connect 10 1 12 0;
#X connect 11 0 1 0;
#X connect 11 1 1 1;
#X connect 13 0 14 0;
#X connect 14 0 2 1;
#X connect 15 0 16 1;
#X connect 16 0 3 1;
#X restore 278 31 pd list-of-onsets-in-buffer;
#X msg 437 9 reset;
#X obj 26 49 catch~ slices;
#X obj 241 -167 essentiaRT~ 5;
#X text -140 -312 ...assuming externals are in parent folder...;
#X obj -139 -328 declare -path ../essentiaRT~ -path ../utils;
#X text -143 -165 AUDIO INPUT;
#X text -143 -157 =====================;
#X text 237 -215 ONSET DETECTION;
#X text 237 -207 =====================;
#X floatatom 287 -80 5 0 0 0 - - -;
#X text 324 -81 onset strength;
#X text 331 -59 <<-- will produce an onset when the onset strength
is greater than this value.;
#X obj 237 -328 loadbang;
#X obj 278 -145 spigot 1;
#X obj 333 -165 tgl 15 1 empty empty empty 17 7 0 10 -262144 -1 -1
1 1;
#X text 354 -167 output onsets;
#X floatatom 359 -14 5 0 0 0 - init_filterevents -;
#X text 397 -15 <<-- outputs only 1 onset every n miliseconds.;
#X text -143 9 =====================;
#X text -143 1 AUDIO OUTPUT;
#X msg -139 -114 station \$1;
#X floatatom -139 -135 5 0 7 0 - - -;
#X obj -100 -68 print STATION;
#X obj -139 -90 radioin;
#X text -101 -136 pick a radio station;
#X obj -80 49 hsl 100 15 0 1 0 1 empty init_volume empty -2 -8 0 10
-262144 -1 -1 9900 1;
#X obj -43 162 line~;
#X obj -83 162 line~;
#X obj 11 194 *~;
#X obj -139 194 *~;
#X obj -83 75 - 1;
#X obj -83 96 abs;
#X obj -83 118 sqrt;
#X msg -83 140 \$1 20;
#X obj -43 75 sqrt;
#X text -83 32 crossfade;
#X obj -139 49 r~ input;
#X obj -139 -24 s~ input;
#X obj 241 -188 r~ input;
#X text -143 -277 =====================;
#X obj 28 -46 s buffer_size;
#X floatatom 28 -66 5 0 0 0 - init_buffer_size -;
#X obj 286 54 print ONSET-TIMES;
#X obj 278 6 filtevent 1000;
#X obj 257 26 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X msg -43 140 \$1 20;
#X obj -131 -46 delwrite~ \$0-deline 10000;
#X msg 237 -305 bang \; pd dsp 1 \; init_threshold set 1 \; init_filterevents
set 1000 \; init_volume 0.5 \; init_buffer_size set 10000;
#X text -141 -285 essentiaRT~ example-2;
#X obj 278 77 s onset_times;
#X text -141 -265 This example uses an independent clock (metro) to
retrieve and playback the incoming audio at the selected onset positions.
We achieve that by using an extra timer to measure the elapsed time
between the last onset list reported and the query time.;
#X obj 263 129 cnv 15 100 130 empty empty empty 20 12 0 14 -261682
-66577 0;
#X text 257 113 =====================;
#X text 257 105 ONSET RETRIEVAL;
#X floatatom 326 137 5 0 0 0 - - -;
#X obj 275 159 metro 300;
#X obj 274 138 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 368 159 r onset_times;
#X obj 308 227 timer;
#X obj 377 353 +;
#X obj 393 284 random;
#X obj 426 262 length;
#X obj 407 444 throw~ slices;
#X obj 377 398 delread~ \$0-deline;
#X obj 407 422 *~;
#X obj 374 310 list split;
#X obj 402 332 sum;
#X obj 374 218 list;
#X obj 368 180 t b l;
#X obj 275 181 t b b;
#X obj 374 240 t l b l;
#X obj 377 375 quickenv 5;
#X text 65 211 extra timer to measure the elapsed time;
#X text 69 225 between onset report and query.;
#X text 365 136 <- speed of new onsets (ms);
#X connect 2 0 3 0;
#X connect 3 0 6 0;
#X connect 3 0 17 0;
#X connect 4 0 0 0;
#X connect 4 0 51 0;
#X connect 5 0 6 1;
#X connect 6 0 4 0;
#X connect 7 0 50 0;
#X connect 7 0 57 0;
#X connect 8 0 7 1;
#X connect 9 0 36 1;
#X connect 10 1 21 0;
#X connect 20 0 55 0;
#X connect 21 0 2 0;
#X connect 22 0 21 1;
#X connect 24 0 51 1;
#X connect 28 0 31 0;
#X connect 29 0 28 0;
#X connect 31 0 45 0;
#X connect 31 0 54 0;
#X connect 31 2 30 0;
#X connect 33 0 38 0;
#X connect 33 0 42 0;
#X connect 34 0 36 0;
#X connect 35 0 37 1;
#X connect 36 0 1 1;
#X connect 37 0 1 0;
#X connect 38 0 39 0;
#X connect 39 0 40 0;
#X connect 40 0 41 0;
#X connect 41 0 35 0;
#X connect 42 0 53 0;
#X connect 44 0 37 0;
#X connect 46 0 10 0;
#X connect 49 0 48 0;
#X connect 51 0 7 0;
#X connect 51 0 52 0;
#X connect 53 0 34 0;
#X connect 62 0 63 1;
#X connect 63 0 77 0;
#X connect 64 0 63 0;
#X connect 65 0 76 0;
#X connect 66 0 67 0;
#X connect 67 0 79 0;
#X connect 68 0 73 1;
#X connect 69 0 68 1;
#X connect 71 0 72 0;
#X connect 72 0 70 0;
#X connect 73 1 74 0;
#X connect 74 0 67 1;
#X connect 75 0 78 0;
#X connect 76 0 66 0;
#X connect 76 1 75 1;
#X connect 77 0 66 1;
#X connect 77 1 75 0;
#X connect 78 0 73 0;
#X connect 78 1 68 0;
#X connect 78 2 69 0;
#X connect 79 0 71 0;
#X connect 79 1 72 1;
