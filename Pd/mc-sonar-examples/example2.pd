#N canvas 668 72 1079 612 10;
#X declare -path ../essentiaRT~ -path ../utils -path ../ibt_pd;
#X obj 267 -134 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj -65 78 output~;
#X obj 288 -263 route list;
#X obj 288 -242 route onset_strength;
#X obj 288 -156 sel 1;
#X floatatom 303 -199 5 0 0 0 - init_threshold -;
#X obj 288 -178 > 1;
#X obj 36 -104 catch~ slices;
#X text -130 -462 ...assuming externals are in parent folder...;
#X text -133 -318 AUDIO INPUT;
#X text -133 -310 =====================;
#X text 247 -355 ONSET DETECTION;
#X text 247 -347 =====================;
#X floatatom 297 -220 5 0 0 0 - - -;
#X text 334 -221 onset strength;
#X obj 247 -478 loadbang;
#X obj 288 -285 spigot 1;
#X obj 343 -305 tgl 15 1 empty empty empty 17 7 0 10 -262144 -1 -1
1 1;
#X text 364 -307 output onsets;
#X floatatom 363 -154 5 0 0 0 - init_filterevents -;
#X text -133 -144 =====================;
#X text -133 -152 AUDIO OUTPUT;
#X msg -129 -267 station \$1;
#X floatatom -129 -288 5 0 7 0 - - -;
#X obj -90 -221 print STATION;
#X obj -129 -243 radioin;
#X obj -70 -104 hsl 100 15 0 1 0 1 empty init_volume empty -2 -8 0
10 -262144 -1 -1 4950 1;
#X obj -33 9 line~;
#X obj -73 9 line~;
#X obj 21 41 *~;
#X obj -129 41 *~;
#X obj -73 -78 - 1;
#X obj -73 -57 abs;
#X obj -73 -35 sqrt;
#X msg -73 -13 \$1 20;
#X obj -33 -78 sqrt;
#X text -73 -121 crossfade;
#X obj -129 -104 r~ input;
#X obj -129 -177 s~ input;
#X obj 251 -328 r~ input;
#X text -133 -420 =====================;
#X obj 38 -199 s buffer_size;
#X floatatom 38 -219 5 0 0 0 - init_buffer_size -;
#X obj 267 -114 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X msg -33 -13 \$1 20;
#X obj -121 -199 delwrite~ \$0-deline 10000;
#X text -131 -428 essentiaRT~ example-2;
#X text 502 -476 =====================;
#X text 502 -484 ONSET RETRIEVAL;
#X obj 563 -260 metro 300;
#X obj 563 -281 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1
1 1;
#X obj 656 -260 r onset_times;
#X obj 596 -172 timer;
#X obj 665 -16 +;
#X obj 681 -85 random;
#X obj 714 -107 length;
#X obj 695 75 throw~ slices;
#X obj 665 29 delread~ \$0-deline;
#X obj 695 53 *~;
#X obj 662 -59 list split;
#X obj 690 -37 sum;
#X obj 662 -211 list;
#X obj 656 -239 t b l;
#X obj 563 -238 t b b;
#X obj 662 -129 t l b l;
#X text 671 -160 between onset report and query.;
#X obj 505 -434 ibt_pd;
#X obj 505 -456 r~ input;
#X obj -129 -478 declare -path ../essentiaRT~ -path ../utils -path
../ibt_pd;
#X text 548 -435 <- bpm estimation;
#X floatatom 632 -410 5 0 0 1 manual init_manual_tempo -;
#X obj 614 -351 pack f f;
#X obj 632 -387 t b f;
#X obj 677 -369 tgl 15 1 empty empty empty 17 7 0 10 -262144 -1 -1
0 1;
#X obj 677 -344 + 1;
#X floatatom 538 -411 5 0 0 1 automatic - -;
#X obj 614 -281 /;
#X msg 614 -304 60000 \$1;
#X floatatom 687 -310 5 0 0 0 - - -;
#X text 700 -379 accomodate mashup to original tempo (0);
#X text 700 -366 or introduce tempo manually (1);
#X msg 247 -455 bang \; pd dsp 1 \; init_threshold set 1 \; init_filterevents
set 500 \; init_volume 0.5 \; init_buffer_size set 10000 \; init_manual_tempo
100;
#X text 632 -174 <<--- extra timer to measure the elapsed time;
#X text 479 -282 start mashup!;
#X text -131 -408 This example uses an independent clock (metro) to
playback the incoming audio at the selected onset positions. We achieve
that by using an extra timer to measure the elapsed time between the
last onset-list reported and the query time.;
#X obj 614 -327 packel 1;
#X text -91 -289 pick a radio station (0-7);
#X obj 296 -27 print ONSET-TIMES;
#X obj 288 -4 s onset_times;
#X obj 296 -48 spigot 0;
#X obj 341 -68 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X msg 294 -111 reset;
#X floatatom 369 -110 5 0 0 0 - init_buffer_size -;
#X obj 251 -307 essentiaRT~ 12;
#X obj 288 -89 list_iot 10000;
#X obj 288 -134 speedlim 500;
#X obj 665 6 trapenv 5;
#X connect 2 0 3 0;
#X connect 3 0 6 0;
#X connect 3 0 13 0;
#X connect 4 0 0 0;
#X connect 4 0 95 0;
#X connect 5 0 6 1;
#X connect 6 0 4 0;
#X connect 7 0 29 1;
#X connect 15 0 81 0;
#X connect 16 0 2 0;
#X connect 17 0 16 1;
#X connect 19 0 95 1;
#X connect 22 0 25 0;
#X connect 23 0 22 0;
#X connect 25 0 38 0;
#X connect 25 0 45 0;
#X connect 25 2 24 0;
#X connect 26 0 31 0;
#X connect 26 0 35 0;
#X connect 27 0 29 0;
#X connect 28 0 30 1;
#X connect 29 0 1 1;
#X connect 30 0 1 0;
#X connect 31 0 32 0;
#X connect 32 0 33 0;
#X connect 33 0 34 0;
#X connect 34 0 28 0;
#X connect 35 0 44 0;
#X connect 37 0 30 0;
#X connect 39 0 93 0;
#X connect 42 0 41 0;
#X connect 43 0 50 0;
#X connect 44 0 27 0;
#X connect 49 0 63 0;
#X connect 50 0 49 0;
#X connect 51 0 62 0;
#X connect 52 0 53 0;
#X connect 53 0 96 0;
#X connect 54 0 59 1;
#X connect 55 0 54 1;
#X connect 57 0 58 0;
#X connect 58 0 56 0;
#X connect 59 1 60 0;
#X connect 60 0 53 1;
#X connect 61 0 64 0;
#X connect 62 0 52 0;
#X connect 62 1 61 1;
#X connect 63 0 52 1;
#X connect 63 1 61 0;
#X connect 64 0 59 0;
#X connect 64 1 54 0;
#X connect 64 2 55 0;
#X connect 66 1 75 0;
#X connect 67 0 66 0;
#X connect 70 0 72 0;
#X connect 71 0 85 0;
#X connect 72 0 71 0;
#X connect 72 1 71 1;
#X connect 73 0 74 0;
#X connect 74 0 85 1;
#X connect 75 0 71 0;
#X connect 76 0 49 1;
#X connect 77 0 76 0;
#X connect 85 0 77 0;
#X connect 85 0 78 0;
#X connect 89 0 87 0;
#X connect 90 0 89 1;
#X connect 91 0 94 0;
#X connect 92 0 94 1;
#X connect 93 1 16 0;
#X connect 94 0 89 0;
#X connect 94 0 88 0;
#X connect 95 0 43 0;
#X connect 95 0 94 0;
#X connect 96 0 57 0;
#X connect 96 1 58 1;
